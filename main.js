// --- Translations ---
const translations = {
    ko: {
        pageTitle: "LottoLuck - 행운의 로또 번호 생성기",
        lottoLuck: "LottoLuck",
        home: "홈",
        blog: "블로그",
        about: "소개",
        contact: "문의",
        privacyPolicy: "개인정보처리방침",
        countrySpecificLottoNumberRecommendation: "국가별 로또 번호 추천",
        lottoGeneratorSubtitle: "아래에서 로또 종류를 선택하고 행운의 번호를 받아보세요!",
        koreaLotto: "한국 로또 6/45",
        usPowerball: "미국 파워볼",
        euromillions: "유로밀리언",
        generateNumbers: "번호 생성",
        howToPlayTitle: "게임 방법",
        koreaLottoRules: "1부터 45까지의 숫자 중 6개의 번호를 선택합니다. 매주 토요일 추첨합니다.",
        usPowerballRules: "1부터 69까지의 화이트볼 5개와 1부터 26까지의 파워볼 1개를 선택합니다. 잭팟 당첨 확률이 매우 낮지만, 상금이 어마어마합니다.",
        euromillionsRules: "1부터 50까지의 메인 번호 5개와 1부터 12까지의 럭키 스타 번호 2개를 선택합니다. 유럽 9개국에서 공동으로 운영합니다.",
        statisticsTitle: "재미로 보는 통계",
        hotNumbers: "자주 나온 번호 (Hot)",
        hotNumbersDesc: "최근 추첨에서 자주 등장한 번호들입니다. (자리 표시자 데이터)",
        coldNumbers: "오래 나온 번호 (Cold)",
        coldNumbersDesc: "최근 추첨에서 오랫동안 등장하지 않은 번호들입니다. (자리 표시자 데이터)",
        aboutPageTitle: "소개 - LottoLuck",
        aboutUs: "소개",
        aboutUsWelcome: "LottoLuck에 오신 것을 환영합니다! 저희는 가장 재미있고 즐거운 로또 번호 생성 경험을 제공하기 위해 최선을 다하고 있습니다.",
        aboutUsMission: "저희의 임무는 전 세계 로또 애호가들을 위해 간단하고 재미있으며 유용한 도구를 제공하는 것입니다. 저희는 게임의 스릴과 잭팟의 꿈을 믿으며, 여러분의 여정에 함께하고 싶습니다.",
        aboutUsProject: "이 웹사이트는 웹을 위한 유용한 것을 만드는 것을 좋아하는 열정적인 개발자가 만들고 유지하는 1인 프로젝트입니다. 저희는 지속적으로 사이트를 개선하고 새로운 기능을 추가하기 위해 노력하고 있습니다.",
        aboutUsThanks: "방문해주셔서 감사합니다. 행운을 빕니다!",
        contactPageTitle: "문의 - LottoLuck",
        contactUsTitle: "문의하기",
        contactUsMessage: "질문, 피드백 또는 파트너십 문의가 있으시면 아래 양식을 사용하여 언제든지 저희에게 연락주세요. 하지만 먼저 FAQ 섹션을 확인해주세요!",
        nameLabel: "이름",
        namePlaceholder: "이름을 입력하세요",
        emailLabel: "이메일",
        emailPlaceholder: "이메일 주소를 입력하세요",
        messageLabel: "메시지",
        messagePlaceholder: "메시지를 입력하세요...",
        submitInquiry: "문의 제출",
        blogPageTitle: "블로그 - LottoLuck",
        blogTitle: "블로그",
        blogSubtitle: "로또와 관련된 최신 소식, 팁, 그리고 재미있는 이야기들을 만나보세요.",
        blogPost1Title: "로또 당첨 번호, 패턴이 있을까? 과학과 미신의 경계",
        blogPost1Content: "많은 사람들이 로또 번호에서 패턴을 찾으려 하지만, 수학적으로 모든 번호의 당첨 확률은 동일합니다. 각 추첨은 독립적인 사건이기 때문에 이전 결과가 다음 결과에 영향을 주지 않습니다. 이는 '도박사의 오류'라는 인지적 편향과 관련이 있습니다. 하지만 '핫' 번호(최근 자주 나온 번호)와 '콜드' 번호(최근 나오지 않은 번호)를 분석하는 것은 많은 사람들에게 재미있는 전략이 됩니다. LottoLuck은 이러한 통계 정보를 제공하여 여러분 자신만의 행운의 조합을 만드는 데 도움을 줍니다. 과학적 근거는 없지만, 자신만의 논리를 적용해 번호를 고르는 즐거움을 더할 수 있습니다.",
        blogPost2Title: "전 세계의 특이한 로또들: 상금부터 추첨 방식까지",
        blogPost2Content: "우리에게 익숙한 로또 외에도 세계에는 독특한 방식의 로또가 많습니다. 예를 들어, 스페인의 크리스마스 복권 '엘 고르도(El Gordo)'는 총상금 규모가 세계 최대 수준이며, 여러 사람이 당첨의 기쁨을 나누는 구조로 유명합니다. 이탈리아의 '수페르에날로토(SuperEnalotto)'는 당첨자가 나오지 않으면 상금이 무한 이월되어 천문학적인 액수로 커지기도 합니다. 이 글에서는 각국의 문화가 담긴 특색 있는 로또들을 소개하고, 그 역사와 운영 방식, 그리고 재미있는 일화들을 알아봅니다.",
        koreaLottoInfo: "1부터 45까지의 숫자 중 6개를 선택합니다.",
        usPowerballInfo: "1부터 69까지의 숫자 5개와 1부터 26까지의 파워볼 숫자 1개를 선택합니다.",
        euromillionsInfo: "1부터 50까지의 숫자 5개와 1부터 12까지의 럭키 스타 숫자 2개를 선택합니다.",
        numGamesLabel: "게임 수",
        numGames1: "1 게임",
        numGames2: "2 게임",
        numGames3: "3 게임",
        numGames4: "4 게임",
        numGames5: "5 게임",
        gamePrefix: "게임",
        faqTitle: "자주 묻는 질문 (FAQ)",
        faq1Title: "LottoLuck 번호는 당첨 확률이 더 높은가요?",
        faq1Content: "아니요, 저희가 생성하는 번호는 완전히 무작위이며 다른 번호보다 당첨 확률이 높지 않습니다. 로또는 공정한 확률 게임이며 저희 서비스는 재미와 편의를 위해 번호를 추천해 드리는 것입니다.",
        faq2Title: "이 사이트는 무료로 사용할 수 있나요?",
        faq2Content: "네, LottoLuck의 모든 기능은 완전히 무료입니다. 저희는 광고 수익을 통해 사이트를 운영하고 있습니다.",
        faq3Title: "새로운 로또 종류를 추가해 줄 수 있나요?",
        faq3Content: "물론입니다! 어떤 로또를 추가하기를 원하시는지 문의 양식을 통해 알려주세요. 사용자들의 요청을 적극적으로 검토하여 새로운 기능을 추가하기 위해 노력하고 있습니다.",
        faq4Title: "제 개인정보는 안전하게 보호되나요?",
        faq4Content: "네, 저희는 사용자의 개인정보를 매우 중요하게 생각합니다. 자세한 내용은 <a href=\"privacy.html\">개인정보처리방침</a> 페이지를 참고해 주세요."
    },
    en: {
        pageTitle: "LottoLuck - Lucky Lotto Number Generator",
        lottoLuck: "LottoLuck",
        home: "Home",
        blog: "Blog",
        about: "About",
        contact: "Contact",
        privacyPolicy: "Privacy Policy",
        countrySpecificLottoNumberRecommendation: "Country-Specific Lotto Number Recommendation",
        lottoGeneratorSubtitle: "Select a lottery below and get your lucky numbers!",
        koreaLotto: "Korea Lotto 6/45",
        usPowerball: "US Powerball",
        euromillions: "EuroMillions",
        generateNumbers: "Generate Numbers",
        howToPlayTitle: "How to Play",
        koreaLottoRules: "Choose 6 numbers from 1 to 45. Draws are held every Saturday.",
        usPowerballRules: "Choose 5 white balls from 1 to 69 and 1 Powerball from 1 to 26. The odds of winning the jackpot are very low, but the prizes are enormous.",
        euromillionsRules: "Choose 5 main numbers from 1 to 50 and 2 Lucky Star numbers from 1 to 12. It is jointly operated by 9 European countries.",
        statisticsTitle: "Fun Statistics",
        hotNumbers: "Hot Numbers",
        hotNumbersDesc: "Numbers that have appeared frequently in recent draws. (Placeholder data)",
        coldNumbers: "Cold Numbers",
        coldNumbersDesc: "Numbers that have not appeared for a long time in recent draws. (Placeholder data)",
        aboutPageTitle: "About - LottoLuck",
        aboutUs: "About Us",
        aboutUsWelcome: "Welcome to LottoLuck! We are dedicated to providing you with the best and most entertaining lottery number generation experience.",
        aboutUsMission: "Our mission is to offer a simple, fun, and useful tool for lottery enthusiasts around the world. We believe in the thrill of the game and the dream of hitting the jackpot, and we want to be a part of your journey.",
        aboutUsProject: "This website is a one-person project, created and maintained by a passionate developer who loves to build useful things for the web. We are constantly working to improve the site and add new features.",
        aboutUsThanks: "Thank you for visiting, and good luck!",
        contactPageTitle: "Contact - LottoLuck",
        contactUsTitle: "Contact Us",
        contactUsMessage: "If you have any questions, feedback, or partnership inquiries, please don't hesitate to reach out to us using the form below. But first, check our FAQ section!",
        nameLabel: "Name",
        namePlaceholder: "Your Name",
        emailLabel: "Email",
        emailPlaceholder: "Your Email",
        messageLabel: "Message",
        messagePlaceholder: "Your message...",
        submitInquiry: "Submit Inquiry",
        blogPageTitle: "Blog - LottoLuck",
        blogTitle: "Blog",
        blogSubtitle: "Check out the latest news, tips, and fun stories related to lotteries.",
        blogPost1Title: "Is There a Pattern in Lottery Winning Numbers? The Line Between Science and Superstition",
        blogPost1Content: "Many people try to find patterns in lottery numbers, but mathematically, the probability of any number being drawn is the same. Each draw is an independent event, meaning previous results do not affect the next outcome. This is related to a cognitive bias called the 'Gambler's Fallacy.' However, analyzing 'hot' numbers (frequently drawn recently) and 'cold' numbers (not drawn recently) is a fun strategy for many. LottoLuck provides this statistical information to help you create your own lucky combinations. While there is no scientific basis, it adds to the enjoyment of picking numbers with your own logic.",
        blogPost2Title: "Unique Lotteries Around the World: From Prizes to Drawing Methods",
        blogPost2Content: "Besides the lotteries we are familiar with, there are many unique ones around the world. For example, Spain's Christmas Lottery, 'El Gordo,' has one of the largest total prize pools and is famous for its structure that allows many people to share the joy of winning. Italy's 'SuperEnalotto' can roll over to astronomical amounts if there is no winner. In this article, we introduce distinctive lotteries that reflect the cultures of their countries, exploring their history, how they work, and interesting anecdotes.",
        koreaLottoInfo: "Choose 6 numbers from 1 to 45.",
        usPowerballInfo: "Choose 5 numbers from 1 to 69 and 1 Powerball number from 1 to 26.",
        euromillionsInfo: "Choose 5 main numbers from 1 to 50 and 2 Lucky Star numbers from 1 to 12.",
        numGamesLabel: "Number of Games",
        numGames1: "1 Game",
        numGames2: "2 Games",
        numGames3: "3 Games",
        numGames4: "4 Games",
        numGames5: "5 Games",
        gamePrefix: "Game",
        faqTitle: "Frequently Asked Questions (FAQ)",
        faq1Title: "Are LottoLuck numbers more likely to win?",
        faq1Content: "No, the numbers we generate are completely random and are not more likely to win than any other numbers. The lottery is a game of fair chance, and our service is for fun and convenience.",
        faq2Title: "Is this site free to use?",
        faq2Content: "Yes, all features of LottoLuck are completely free. We operate the site through advertising revenue.",
        faq3Title: "Can you add a new type of lottery?",
        faq3Content: "Of course! Please let us know which lottery you would like us to add via the contact form. We are actively reviewing user requests to add new features.",
        faq4Title: "Is my personal information safe?",
        faq4Content: "Yes, we take your privacy very seriously. Please see our <a href=\"privacy.html\">Privacy Policy</a> page for more details."
    }
};

// --- Blog Posts Data ---
const blogPosts = [
    {
        id: 1,
        date: '2024년 6월 28일',
        titleKey: 'blogPost1Title',
        contentKey: 'blogPost1Content',
        salAnim: 'slide-right'
    },
    {
        id: 2,
        date: '2024년 6월 25일',
        titleKey: 'blogPost2Title',
        contentKey: 'blogPost2Content',
        salAnim: 'slide-left'
    }
];

// --- Internationalization (i18n) Logic ---
let currentLang = localStorage.getItem('lang') || 'ko'; // Default to Korean

function translatePage() {
    document.documentElement.lang = currentLang;

    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (translations[currentLang] && translations[currentLang][key]) {
            element.innerHTML = translations[currentLang][key];
        }
    });

    document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
        const key = element.getAttribute('data-i18n-placeholder');
        if (translations[currentLang] && translations[currentLang][key]) {
            element.placeholder = translations[currentLang][key];
        }
    });

    const activeLangSpan = document.getElementById('active-lang');
    if (activeLangSpan) {
        activeLangSpan.textContent = currentLang === 'ko' ? '한국어' : 'English';
    }

    // Update lotto info if it's visible
    const lottoInfoDiv = document.getElementById('lotto-info');
    const lottoTypeSelect = document.getElementById('lotto-type');
    if (lottoInfoDiv && lottoTypeSelect) {
        const lottoType = lottoTypeSelect.value;
        const details = lottoDetails[lottoType];
        if (details) {
            lottoInfoDiv.textContent = translations[currentLang][details.infoKey];
        }
    }
    
    // Render blog posts if on the blog page
    renderBlogPosts();
}

function setLanguage(lang) {
    localStorage.setItem('lang', lang);
    currentLang = lang;
    translatePage();
}

// --- Blog Post Rendering ---
function renderBlogPosts() {
    const blogPostsContainer = document.getElementById('blog-posts');
    if (!blogPostsContainer) return; // Only run on blog page

    blogPostsContainer.innerHTML = ''; // Clear existing posts
    const lang = currentLang;

    blogPosts.forEach(post => {
        const article = document.createElement('article');
        article.setAttribute('data-sal', post.salAnim);

        const header = document.createElement('header');
        const title = document.createElement('h3');
        title.textContent = translations[lang][post.titleKey] || 'Title not found';
        header.appendChild(title);

        const content = document.createElement('p');
        content.innerHTML = translations[lang][post.contentKey] || 'Content not found';

        const footer = document.createElement('footer');
        const date = document.createElement('small');
        date.textContent = post.date;
        footer.appendChild(date);

        article.appendChild(header);
        article.appendChild(content);
        article.appendChild(footer);

        blogPostsContainer.appendChild(article);
    });
    sal.update();
}


// --- Lottery Number Generator Logic ---
const generateBtn = document.getElementById('generate');
const numbersDiv = document.getElementById('numbers');
const lottoTypeSelect = document.getElementById('lotto-type');
const lottoInfoDiv = document.getElementById('lotto-info');
const numGamesSelect = document.getElementById('num-games-select');


const lottoDetails = {
    'korea-lotto': {
        range: 45,
        count: 6,
        maxGames: 5,
        infoKey: 'koreaLottoInfo'
    },
    'us-powerball': {
        range: 69,
        count: 5,
        powerballRange: 26,
        powerballCount: 1,
        maxGames: 3, 
        infoKey: 'usPowerballInfo'
    },
    'euromillions': {
        range: 50,
        count: 5,
        luckyStarRange: 12,
        luckyStarCount: 2,
        maxGames: 2,
        infoKey: 'euromillionsInfo'
    }
};

function updateNumGamesOptions() {
    if (!lottoTypeSelect) return;
    const selectedLotto = lottoTypeSelect.value;
    const details = lottoDetails[selectedLotto];
    numGamesSelect.innerHTML = '';
    for (let i = 1; i <= details.maxGames; i++) {
        const option = document.createElement('option');
        option.value = i;
        option.textContent = `${translations[currentLang].gamePrefix} ${i}`;
        numGamesSelect.appendChild(option);
    }
}

function generateNumbers() {
    if (!lottoTypeSelect || !numGamesSelect || !numbersDiv) return;

    const selectedLotto = lottoTypeSelect.value;
    const details = lottoDetails[selectedLotto];
    const numGamesToGenerate = parseInt(numGamesSelect.value);

    numbersDiv.innerHTML = ''; // Clear previous numbers

    for (let game = 0; game < numGamesToGenerate; game++) {
        const gameContainer = document.createElement('div');
        gameContainer.classList.add('game-container');

        const gameLabel = document.createElement('h4');
        gameLabel.textContent = `${translations[currentLang].gamePrefix} ${game + 1}`;
        gameContainer.appendChild(gameLabel);

        const numbersDisplay = document.createElement('div');
        numbersDisplay.classList.add('numbers-display');
        gameContainer.appendChild(numbersDisplay);

        const numbers = new Set();
        while (numbers.size < details.count) {
            numbers.add(Math.floor(Math.random() * details.range) + 1);
        }

        [...numbers].sort((a, b) => a - b).forEach((number, index) => {
            const numberDiv = document.createElement('div');
            numberDiv.classList.add('number', 'lotto-ball-animated');
            numberDiv.textContent = number;
            numberDiv.style.animationDelay = `${(game * 0.5) + (index * 0.1)}s`;
            numbersDisplay.appendChild(numberDiv);
        });

        if (details.powerballCount) {
            const powerballNumbers = new Set();
            while (powerballNumbers.size < details.powerballCount) {
                powerballNumbers.add(Math.floor(Math.random() * details.powerballRange) + 1);
            }
            [...powerballNumbers].forEach((number, index) => {
                const numberDiv = document.createElement('div');
                numberDiv.classList.add('number', 'powerball', 'lotto-ball-animated');
                numberDiv.textContent = number;
                numberDiv.style.animationDelay = `${(game * 0.5) + (numbers.size * 0.1) + (index * 0.1)}s`;
                numbersDisplay.appendChild(numberDiv);
            });
        }
        
        if (details.luckyStarCount) {
            const luckyStarNumbers = new Set();
            while (luckyStarNumbers.size < details.luckyStarCount) {
                luckyStarNumbers.add(Math.floor(Math.random() * details.luckyStarRange) + 1);
            }
            [...luckyStarNumbers].sort((a, b) => a - b).forEach((number, index) => {
                const numberDiv = document.createElement('div');
                numberDiv.classList.add('number', 'lucky-star', 'lotto-ball-animated');
                numberDiv.textContent = number;
                numberDiv.style.animationDelay = `${(game * 0.5) + (numbers.size * 0.1) + (details.powerballCount || 0) * 0.1 + (index * 0.1)}s`;
                numbersDisplay.appendChild(numberDiv);
            });
        }
        numbersDiv.appendChild(gameContainer);
    }

    if (lottoInfoDiv) {
        lottoInfoDiv.textContent = translations[currentLang][details.infoKey];
    }
}


// --- DOMContentLoaded Initialization ---
document.addEventListener('DOMContentLoaded', () => {
    sal({ once: false }); // Initialize Sal.js

    // Attach language switcher event listeners
    const langKoBtn = document.getElementById('lang-ko');
    const langEnBtn = document.getElementById('lang-en');
    if (langKoBtn) langKoBtn.addEventListener('click', (e) => { e.preventDefault(); setLanguage('ko'); });
    if (langEnBtn) langEnBtn.addEventListener('click', (e) => { e.preventDefault(); setLanguage('en'); });

    // Attach lottery generator listeners if on the main page
    if (document.getElementById('lotto-generator')) {
        lottoTypeSelect.addEventListener('change', () => {
            updateNumGamesOptions(); 
            generateNumbers(); 
        });
        numGamesSelect.addEventListener('change', generateNumbers); 
        generateBtn.addEventListener('click', generateNumbers);

        updateNumGamesOptions();
        generateNumbers(); 
    }
    
    // Set language and translate page last
    translatePage();
});
